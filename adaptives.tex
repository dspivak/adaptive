\documentclass[11pt, one side, article]{memoir}


\settrims{0pt}{0pt} % page and stock same size
\settypeblocksize{*}{33.5pc}{*} % {height}{width}{ratio}
\setlrmargins{*}{*}{1} % {spine}{edge}{ratio}
\setulmarginsandblock{.98in}{.98in}{*} % height of typeblock computed
\setheadfoot{\onelineskip}{2\onelineskip} % {headheight}{footskip}
\setheaderspaces{*}{1.5\onelineskip}{*} % {headdrop}{headsep}{ratio}
\checkandfixthelayout


\usepackage{amsthm}
\usepackage{mathtools}

\usepackage[inline]{enumitem}
\usepackage{ifthen}
\usepackage[utf8]{inputenc} %allows non-ascii in bib file
\usepackage{xcolor}

\usepackage[backend=biber, backref=true, maxbibnames = 10, style = alphabetic]{biblatex}
\usepackage[bookmarks=true, colorlinks=true, linkcolor=blue!50!black,
citecolor=orange!50!black, urlcolor=orange!50!black, pdfencoding=unicode]{hyperref}
\usepackage[capitalize]{cleveref}

\usepackage{tikz}

\usepackage{amssymb}
\usepackage{newpxtext}
\usepackage[varg,bigdelims]{newpxmath}
\usepackage{mathrsfs}
\usepackage{dutchcal}
\usepackage{fontawesome}
\usepackage{ebproof}
\usepackage{stmaryrd}


% cleveref %
  \newcommand{\creflastconjunction}{, and\nobreakspace} % serial comma
  \crefformat{enumi}{\card#2#1#3}
  \crefalias{chapter}{section}


% biblatex %
  \addbibresource{Library20220421.bib} 

% hyperref %
  \hypersetup{final}

% enumitem %
  \setlist{nosep}
  \setlistdepth{6}



% tikz %



  \usetikzlibrary{ 
  	cd,
  	math,
  	decorations.markings,
		decorations.pathreplacing,
  	positioning,
  	arrows.meta,
  	shapes,
		shadows,
		shadings,
  	calc,
  	fit,
  	quotes,
  	intersections,
    circuits,
    circuits.ee.IEC
  }
  
  \tikzset{
biml/.tip={Glyph[glyph math command=triangleleft, glyph length=.95ex]},
bimr/.tip={Glyph[glyph math command=triangleright, glyph length=.95ex]},
}

\tikzset{
	tick/.style={postaction={
  	decorate,
    decoration={markings, mark=at position 0.5 with
    	{\draw[-] (0,.4ex) -- (0,-.4ex);}}}
  }
} 
\tikzset{
	slash/.style={postaction={
  	decorate,
    decoration={markings, mark=at position 0.5 with
    	{\node[font=\footnotesize] {\rotatebox{90}{$\sim$}};}}}
  }
} 

\newcommand{\upp}{\begin{tikzcd}[row sep=6pt]~\\~\ar[u, bend left=50pt, looseness=1.3, start anchor=east, end anchor=east]\end{tikzcd}}

\newcommand{\bito}[1][]{
	\begin{tikzcd}[ampersand replacement=\&, cramped]\ar[r, biml-bimr, "#1"]\&~\end{tikzcd}  
}
\newcommand{\bifrom}[1][]{
	\begin{tikzcd}[ampersand replacement=\&, cramped]\ar[r, bimr-biml, "{#1}"]\&~\end{tikzcd}  
}
\newcommand{\bifromlong}[2][]{
	\begin{tikzcd}[ampersand replacement=\&, column sep=#2, cramped]\ar[r, bimr-biml, "#1"]\&~\end{tikzcd}  
}

% Adjunctions
\newcommand{\adj}[5][30pt]{%[size] Cat L, Left, Right, Cat R.
\begin{tikzcd}[ampersand replacement=\&, column sep=#1]
  #2\ar[r, shift left=7pt, "#3"]
  \ar[r, phantom, "\scriptstyle\Rightarrow"]\&
  #5\ar[l, shift left=7pt, "#4"]
\end{tikzcd}
}

\newcommand{\adjr}[5][30pt]{%[size] Cat R, Right, Left, Cat L.
\begin{tikzcd}[ampersand replacement=\&, column sep=#1]
  #2\ar[r, shift left=7pt, "#3"]\&
  #5\ar[l, shift left=7pt, "#4"]
  \ar[l, phantom, "\scriptstyle\Leftarrow"]
\end{tikzcd}
}

\newcommand{\xtickar}[1]{\begin{tikzcd}[baseline=-0.5ex,cramped,sep=small,ampersand 
replacement=\&]{}\ar[r,tick, "{#1}"]\&{}\end{tikzcd}}

\newcommand{\xslashar}[1]{\begin{tikzcd}[baseline=-0.5ex,cramped,sep=small,ampersand 
replacement=\&]{}\ar[r,slash, "{#1}"]\&{}\end{tikzcd}}



  
  % amsthm %
\theoremstyle{definition}
\newtheorem{definitionx}{Definition}[chapter]
\newtheorem{examplex}[definitionx]{Example}
\newtheorem{remarkx}[definitionx]{Remark}
\newtheorem{notation}[definitionx]{Notation}


\theoremstyle{plain}

\newtheorem{theorem}[definitionx]{Theorem}
\newtheorem{proposition}[definitionx]{Proposition}
\newtheorem{corollary}[definitionx]{Corollary}
\newtheorem{lemma}[definitionx]{Lemma}
\newtheorem{warning}[definitionx]{Warning}
\newtheorem*{theorem*}{Theorem}
\newtheorem*{proposition*}{Proposition}
\newtheorem*{corollary*}{Corollary}
\newtheorem*{lemma*}{Lemma}
\newtheorem*{warning*}{Warning}
%\theoremstyle{definition}
%\newtheorem{definition}[theorem]{Definition}
%\newtheorem{construction}[theorem]{Construction}

\newenvironment{example}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{$\lozenge$}\examplex}
  {\popQED\endexamplex}
  
 \newenvironment{remark}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{$\lozenge$}\remarkx}
  {\popQED\endremarkx}
  
  \newenvironment{definition}
  {\pushQED{\qed}\renewcommand{\qedsymbol}{$\lozenge$}\definitionx}
  {\popQED\enddefinitionx} 

    
%-------- Single symbols --------%
	
\DeclareSymbolFont{stmry}{U}{stmry}{m}{n}
\DeclareMathSymbol\fatsemi\mathop{stmry}{"23}

\DeclareFontFamily{U}{mathx}{\hyphenchar\font45}
\DeclareFontShape{U}{mathx}{m}{n}{
      <5> <6> <7> <8> <9> <10>
      <10.95> <12> <14.4> <17.28> <20.74> <24.88>
      mathx10
      }{}
\DeclareSymbolFont{mathx}{U}{mathx}{m}{n}
\DeclareFontSubstitution{U}{mathx}{m}{n}
\DeclareMathAccent{\widecheck}{0}{mathx}{"71}


%-------- Renewed commands --------%

\renewcommand{\ss}{\subseteq}

%-------- Other Macros --------%


\DeclarePairedDelimiter{\present}{\langle}{\rangle}
\DeclarePairedDelimiter{\copair}{[}{]}
\DeclarePairedDelimiter{\floor}{\lfloor}{\rfloor}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\DeclarePairedDelimiter{\corners}{\ulcorner}{\urcorner}
\DeclarePairedDelimiter{\ihom}{[}{]}

\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Mor}{Mor}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\cod}{cod}
\DeclareMathOperator{\idy}{idy}
\DeclareMathOperator{\comp}{com}
\DeclareMathOperator*{\colim}{colim}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\ob}{Ob}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\el}{El}




\newcommand{\const}[1]{\texttt{#1}}%a constant, or named element of a set
\newcommand{\Set}[1]{\mathsf{#1}}%a named set
\newcommand{\ord}[1]{\mathsf{#1}}%an ordinal
\newcommand{\cat}[1]{\mathcal{#1}}%a generic category
\newcommand{\Cat}[1]{\mathbf{#1}}%a named category
\newcommand{\fun}[1]{\mathrm{#1}}%a function
\newcommand{\Fun}[1]{\mathit{#1}}%a named functor




\newcommand{\id}{\mathrm{id}}
\newcommand{\then}{\mathbin{\fatsemi}}

\newcommand{\cocolon}{:\!}


\newcommand{\iso}{\cong}
\newcommand{\too}{\longrightarrow}
\newcommand{\tto}{\rightrightarrows}
\newcommand{\To}[2][]{\xrightarrow[#1]{#2}}
\renewcommand{\Mapsto}[1]{\xmapsto{#1}}
\newcommand{\Tto}[3][13pt]{\begin{tikzcd}[sep=#1, cramped, ampersand replacement=\&, text height=1ex, text depth=.3ex]\ar[r, shift left=2pt, "#2"]\ar[r, shift right=2pt, "#3"']\&{}\end{tikzcd}}
\newcommand{\Too}[1]{\xrightarrow{\;\;#1\;\;}}
\newcommand{\from}{\leftarrow}
\newcommand{\ffrom}{\leftleftarrows}
\newcommand{\From}[1]{\xleftarrow{#1}}
\newcommand{\Fromm}[1]{\xleftarrow{\;\;#1\;\;}}
\newcommand{\surj}{\twoheadrightarrow}
\newcommand{\inj}{\rightarrowtail}
\newcommand{\wavyto}{\rightsquigarrow}
\newcommand{\lollipop}{\multimap}
\newcommand{\imp}{\Rightarrow}
\renewcommand{\iff}{\Leftrightarrow}
\newcommand{\down}{\mathbin{\downarrow}}
\newcommand{\fromto}{\leftrightarrows}
\newcommand{\tickar}{\xtickar{}}
\newcommand{\slashar}{\xslashar{}}
\newcommand{\card}{\,^{\#}}


\newcommand{\inv}{^{-1}}
\newcommand{\op}{^\tn{op}}

\newcommand{\tn}[1]{\textnormal{#1}}
\newcommand{\ol}[1]{\overline{#1}}
\newcommand{\ul}[1]{\underline{#1}}
\newcommand{\wt}[1]{\widetilde{#1}}
\newcommand{\wh}[1]{\widehat{#1}}
\newcommand{\wc}[1]{\widecheck{#1}}
\newcommand{\ubar}[1]{\underaccent{\bar}{#1}}



\newcommand{\bb}{\mathbb{B}}
\newcommand{\cc}{\mathbb{C}}
\newcommand{\nn}{\mathbb{N}}
\newcommand{\pp}{\mathbb{P}}
\newcommand{\qq}{\mathbb{Q}}
\newcommand{\zz}{\mathbb{Z}}
\newcommand{\rr}{\mathbb{R}}


\newcommand{\finset}{\Cat{Fin}}
\newcommand{\smset}{\Cat{Set}}
\newcommand{\smcat}{\Cat{Cat}}
\newcommand{\catsharp}{\Cat{Cat}^{\sharp}}
\newcommand{\ppolyfun}{\mathbb{P}\Cat{olyFun}}
\newcommand{\ccatsharp}{\mathbb{C}\Cat{at}^{\sharp}}
\newcommand{\ccatsharpdisc}{\mathbb{C}\Cat{at}^{\sharp}_{\tn{disc}}}
\newcommand{\ccatsharplin}{\mathbb{C}\Cat{at}^{\sharp}_{\tn{lin}}}
\newcommand{\ccatsharpdisccon}{\mathbb{C}\Cat{at}^{\sharp}_{\tn{disc,con}}}
\newcommand{\sspan}{\mathbb{S}\Cat{pan}}
\newcommand{\en}{\Cat{End}}

\newcommand{\List}{\Fun{List}}
\newcommand{\set}{\tn{-}\Cat{Set}}




\newcommand{\yon}{\mathcal{y}}
\newcommand{\poly}{\Cat{Poly}}
\newcommand{\dir}{\Set{Dir}}
\newcommand{\rect}{\Set{Rect}}
\newcommand{\polycart}{\poly^{\Cat{Cart}}}
\newcommand{\hh}{\mathcal{h}}
\newcommand{\ppoly}{\mathbb{P}\Cat{oly}}
\newcommand{\0}{\textsf{0}}
\newcommand{\1}{\tn{\textsf{1}}}
\newcommand{\tri}{\mathbin{\triangleleft}}
\newcommand{\R}{R}
\newcommand{\T}{T}

% lenses
\newcommand{\biglens}[2]{
     \begin{bmatrix}{\vphantom{f_f^f}#2} \\ {\vphantom{f_f^f}#1} \end{bmatrix}
}
\newcommand{\littlelens}[2]{
     \begin{bsmallmatrix}{\vphantom{f}#2} \\ {\vphantom{f}#1} \end{bsmallmatrix}
}
\newcommand{\lens}[2]{
  \relax\if@display
     \biglens{#1}{#2}
  \else
     \littlelens{#1}{#2}
  \fi
}



\newcommand{\qand}{\quad\text{and}\quad}
\newcommand{\qqand}{\qquad\text{and}\qquad}


\newcommand{\coto}{\nrightarrow}
\newcommand{\cofun}{{\raisebox{2pt}{\resizebox{2.5pt}{2.5pt}{$\setminus$}}}}

\newcommand{\coalg}{\tn{-}\Cat{Coalg}}

\newcommand{\bic}[2]{{}_{#1}\Cat{Comod}_{#2}}


\newcommand{\C}{{\Cat{C}}}
\newcommand{\D}{{\Cat{D}}}
\newcommand{\org}{{\mathbb{O}\Cat{rg}}}
\renewcommand{\S}{{\Cat{S}}}
\newcommand{\blp}{\Big{(}}
\newcommand{\brp}{\Big{)}}
\newcommand{\idcoalg}[1]{{\{\id_{#1}\}}}
\newcommand{\rrp}{\rr_{>0}}
\newcommand{\rrnn}{\rr_{\ge 0}}

\newcommand{\dnote}[1]{{\color{blue}David says:}~#1.\quad{\color{blue}$\lozenge$}}
\newcommand{\bnote}[1]{{\color{red}Brandon says:}~#1.\quad{\color{red}$\lozenge$}}


% ---- Changeable document parameters ---- %

\linespread{1.1}
\allowdisplaybreaks
\setsecnumdepth{section}
\settocdepth{section}
\setlength{\parindent}{15pt}
\setcounter{tocdepth}{1}



%--------------- Document ---------------%
\begin{document}

\title{Adaptives:\\Self-similar hierarchical dynamical systems}

\author{Brandon Shapiro \and David I. Spivak}

\date{\vspace{-.2in}}

\maketitle

\begin{abstract}
Organized systems adapt to internal and external pressures, and this happens all the way down. Being able to think clearly about this idea motivates our paper, and so it is elaborated extensively in the introduction, which should be broadly accessible to a philosophically-interested audience. In the remaining sections, we turn to more compressed category theory. We define the monoidal double category $\org$ and spell out how to think about $\org$-enriched categories, operads, and monoidal categories, in particular how they exemplify these philosophical ideas.
\end{abstract}

%------- Chapter -------%
\chapter{Introduction}

%Organisms don't defy the physics in which they are implemented. But the term \emph{physics}---both as it was originally used and as we mean it here---encompasses much more than simply the fundamental building blocks of reality. 
%
%Experimental data and various insurmountable obstructions prevent the reductionist approach to physics from having any chance at a descriptive account of the macro-level phenomena we see around us \cite{laughlin2005different}. The comparatively feeble concept of \emph{emergence} is then used to capture the discrepancy. One says ``the whole is more than the sum of its parts'', but what sort of thing \emph{is} just the sum of its parts: sand?
%
%Rather than starting from the bottom, failing to arrive at our level of interest, and then adding the discrepancy back as an extra term, we propose that physics should be reconceptualized to include explanations that work at every level simultaneously. Indeed, it may be that the laws of physics are themselves organized. There may be patterns of construction that make sense at all levels, e.g.\ patterns that could be called attraction, entropic ascent, or even birth and death. If one can articulate a mathematical pattern that is subsequently empirically-verified to exist across the spectrum, from atoms to stars, then one may say that such a pattern is \emph{even more real} than a pattern perceivable at only the smallest levels.
%
%It appears that organized matter can exploit self-similarity in the patterns of nature. It seems difficult to \emph{derive} this from fundamental physics, and yet it is repeatedly observed and is not merely biology. One often sees plants with fractal-like symmetries that hold across its hierarchical levels. Trees, riverbeds, and circulatory systems follow similar branching profiles \cite{bejan2000shape}. Even in mathematics, microcosm principles show that in order to display certain structures, a system must be embedded in a world equipped with even higher-level versions of that very structure \cite{baez1997quantum}.
%
%In this article, we propose a new accounting system---a mathematical language---with which to study self-similar dynamical systems.



%
%Brainstorm:\\
%Self-similarity in nature\\
%Polynomial ecosystem\\
%Collectives\\
%Deep learning, gradient descenders\\
%Open dynamical systems\\
%Hierarchy\\
%Organization doesn't defy physics\\

Intuitively, an open dynamical system is a machine or worker with an interface by which to interact with whatever else is out there. Open dynamical systems can be organized as circuits or control loops, so that they affect each other by their outward expressions of internal work, and thereby possibly form a more complex worker. The framework here is fractal---or more precisely \emph{operadic}---in its structure: organizations of workers can be nested into arbitrary hierarchies of abstraction, without changing the activity of these workers as they interact together.

But if we think about some things that interact to do work in the real world, we often notice that often the organization itself---the connections themselves---change. The way we connect this hour may be different from the way we connect next hour; in particular, our interfaces go in and out of contact. At the end of this paragraph, look away from the page for a few seconds, think about some things you know that interact together or influence each other, and ask yourself three questions about them: Do these things ever stop interacting? If so, do they ever start interacting again? And how is it decided? 

\section{Accounting for organizational change}

We propose that the metaphysical nature and scope of these questions should be complemented by some sort of guard rails to keep our contemplation on track. This is the role of mathematics in our work. It provides a symbolic tracking system which is articulate enough to facilitate one in explicating an example and another in asking questions about it.

The category $\poly$ of polynomial functors in one variable is an ergonomic mathematical structure with many applications and spin-off categorical gadgets. We will begin in \cref{chap.org} by recalling one such gadget from \cite{spivak2021learners}: a category-enriched multicategory $\org$ that will be the conceptual centerpiece of our accounting system. Its objects are polynomial functors in one variable, and its morphisms are polynomial coalgebras related to a certain monoidal closed structure on $\poly$. We will see that the morphisms in $\org$ are intuitively ``collective organizational patterns that change through time''.

Leaving the mathematics aside until the next section begins---at which point we will have little more to say about the background philosophy---let's return to the question of how the organizational pattern between various systems is decided, moment-by-moment. Let's mesh this question with the idea that the so-organized systems can be nested into arbitrary hierarchies of abstraction. And let's think about all this in the frame of a certain worldview which we invite you the reader to engage with like a fictional movie, not intended to convince you of fact but instead simply to convey an experience. Here goes.

In this worldview, we notice that everything that makes any sense to us happens to be a collective. A cell body, a human body, an antibody, Topos Institute, an idea, an airport, a sentence, a mathematical definition, a grain of sand, ... each of these is a collective of interacting parts that may themselves be collectives. Stay with an example or two for now, not the counterexamples or counterpoints yet, because there are plenty of examples and they point more toward the subject-matter of this paper.

It's quite often the case that these collectives, like the ship of theseus, are not permanent organizations that are fixed for all time; they are adapting to forces from within and without the system. Even a grain of sand can break or melt; even a mathematical definition can be refactored. So then what's outside the system, generating these forces that influence it? We imagine that in fact what's outside is in fact more of the same kind of stuff as what's inside, just not as cohesive perhaps. Let's go full-on woo: if the universe is a big system, then maybe the sort of thing that happens in our head is---in some way---just like what happens outside of it. Maybe the thing that organizes Brandon and David into a collaborative thinking and paper-writing unit is, in the proper accounting system, the same thing that organizes each one of them into a body. 

But is this right? How could you check such a claim? One would need to give a proper account, and since we as authors can't give such an account, we don't make this claim. Instead, what we present here is an accounting system in which the woo-person, (or would it instead be the reductive materialist?) who thought that what went on inside the head was somehow the same as what went on outside, could endeavor to provide a plausible account of their thinking.

\section{Adaptives}

Our main definition in this paper is what we call an \emph{adaptive}. We might poetically say that an \emph{adaptive} is a structure that is self-similarly self-organizing its interactions with itself. To define it, we first refactor the definition of $\org$ from \cite{spivak2021learners}. Once defined, we give a couple examples of this structure, one of which is a claimed-to-be-accurate account of \emph{deep learning by gradient descent} and the other of which is a toy account of objects influenced by gravity. One might say these are adaptives because ``any organized composite of gradient descenders is a gradient descender'' and because ``any organized composite of gravitational frames is a gravitational frame''. \dnote{Why did the poem not quite fit the examples?}

We thank you the reader for having postponed your counterpoints and counterexamples, and we ask you to reengage both skepticism and interest as you see fit. We invite you to ask openly: what's not a collective of interacting parts that are themselves collectives? Nature, love, or experience perhaps? It all depends on how you look. What we present here is an accounting system for making sense of a certain sort of experiential pattern; the matter itself is whatever it is.

\section{Acknowledgments}

The influences on this paper are too numerous and unranked to name, but in particular we thank Sophie Libkind and Eigil Rischel for stimulating conversations.

This material is based upon work supported by the Air Force Office of Scientific Research under award number FA9550-20-1-0348.


%------- Chapter -------%
\chapter{The Monoidal Double Category $\org$}\label{chap.org}

In \cite{spivak2021learners}, the second author defined a category-enriched multicategory $\org$, whose objects are polynomials and whose morphisms are polynomial coalgebras. In this chapter, we describe how $\org$ in fact more naturally takes the form of a monoidal double category, with coalgebras as horizontal morphisms, maps of polynomials as vertical morphisms, and the Dirichlet tensor product $\otimes$ providing the monoidal structure.%
\footnote{In fact, $\org$ is a duoidal double double category, with a second monoidal structure given by $\tri$, but we will not use that here.}


%--- Section ---%
\section{$[p,q]$-coalgebras}


We first recall the definitions of the internal-hom polynomials $[p,q]$ and concretely describe the category of $[p,q]$-coalgebras, which forms the category of morphisms from $p$ to $q$ in the underlying bicategory of $\org$.

%\dnote{Introduce the notation $p\slashar q$ in this section?}

\begin{definition}\label{coalgebras}
For polynomials 
$$p = \sum_{I \in p(1)} y^{p[I]} \qqand q = \sum_{J \in q(1)} y^{q[J]},$$
their \emph{internal hom} with respect to the tensor product $\otimes$ is the polynomial
\[
[p,q] = \sum_{\phi : p \to q} y^{\sum\limits_{\;I \in p(1)} q[\phi_1(I)]}
\]
\end{definition}

For intuition, a $[p,q]$-coalgebra (denoted $p \slashar q$) is a machine that outputs maps $p\to q$ and inputs what flows out of $p$ and what flows in to $q$. More precisely, using \cite[Definition 2.10]{spivak2021learners} applied to $[p,q]$, we get the following definition of $[p,q]$-coalgebras. 

\begin{definition}
The category $[p,q]\coalg$ has as objects pairs $\S = (S,\beta)$ where $S$ is a set and $\beta : S \to [p,q] \tri S$, and morphisms from $\S$ to $\S'$ given by functions $f : S \to S'$ making \eqref{eqn.coalg_map} commute. 
\begin{equation}\label{eqn.coalg_map}
\begin{tikzcd}
S \rar{\beta} \dar[swap]{f} & {[p,q]} \tri S \dar{{[p,q]} \tri f} \\
S' \rar[swap]{\beta'} & {[p,q]} \tri S'
\end{tikzcd}
\end{equation}
\end{definition}

Unwinding this definition, we get that $\beta$ is determined by a function 
$$\beta_0 : S \to \poly(p,q) = [p,q](1)$$
and for each $s \in S$, a function 
$$\beta_s : \sum_{I \in p(1)} q[\beta_0(s)_1(I)] \to S.$$ 
For each $s \in S$, called a \emph{state}, we call $\beta_0(s)$ the \emph{action of $s$} and $\beta_s$ the \emph{update function of $s$}. A coalgebra map is then a function between the state sets that preserves actions and updates. 

When, for each $s \in S$, the update $\beta_s$ is the constant function sending everything to $s$, we say the coalgebra $\S$ is \emph{static}, as it remains constantly at $s$ regardless of the output $I \in p(1)$ and input $j\in q[\beta_0(s)_1(I)]$.

\begin{example}\label{ex.single_state}
A special case of a static $[p,q]$-coalgebra is given by a map $\phi \in \poly(p,q)$. For each such $\phi$, there is a coalgebra $\{\phi\}$ with a singleton set of states, $\beta_0$ sending the point to $\phi$; it is by necessity static. 

A coalgebra is static iff it is the coproduct of one-element coalgebras.
\end{example}



%--- Section ---%
\section{Composition of morphism coalgebras}
%\dnote{Let's call these something besides coalgebras; they're special coalgebras, a kind that is possible to "compose".}



We now describe how $[p,q]$-coalgebras behave like morphisms from $p$ to $q$.

\begin{proposition}
The categories $[p,q]\coalg$ form the hom-categories in a bicategory $\org$, which has polynomials as objects.
\end{proposition}

It is no accident that $\org$ denotes both this bicategory and the categorical operad in \cite[Definition 2.19]{spivak2021learners}, as both are derived from the monoidal double category $\org$ described in the following sections. For now, we merely present the horizontal identities and composites in this bicategory.

The identity coalgebra in $[p,p]\coalg$ is given by the one-state coalgebra $\idcoalg{p}$. 

Composites are defined as
$$[p,q]\coalg \times [q,r]\coalg \to \blp[p,q] \otimes [q,r]\brp\coalg \to [p,r]\coalg,$$
where the first functor is described in \cite[Proposition 2.13]{spivak2021learners}, and the second is given by the fact that $(-)\coalg$ is a functor $\poly \to \smcat$, using a map of polynomials $[p,q] \otimes [q,r] \to [p,r]$. On positions, this map takes the form
$$\blp[p,q] \otimes [q,r]\brp(1) = \poly(p,q) \times \poly(q,r) \To{\circ} \poly(p,r) = [p,r](1)$$
and on directions it is given for $\phi : p \to q$ and $\psi : q \to r$ by the function
$$\blp\sum_{I \in p(1)} q[\phi_1(I)]\brp \times \blp\sum_{J \in q(1)} r[\psi_1(J)]\brp \from \sum_{I \in p(1)} r[\psi_1(\phi_1(I))]$$
which sends $(I,j)$ to $(I,\psi_{\phi_1(I)}(j),\phi_1(I),j)$. 

Concretely, the composite of a $[p,q]$-coalgebra $\S$ and a $[q,r]$-coalgebra $\S'$ is a $[p,r]$-coalgebra which we denote $\S\then\S'$  and define as follows:
\begin{itemize}
	\item its state set is given by $S \times S'$
	\item the action of the pair $(s,s')$ is given by the composite 
$$p \To{\beta_0(s)} q \To{\beta'_0(s')} r$$
	\item the update function of $(s,s')$ is induced by the functions
$$\sum_{I \in p(1)} r[\beta'_0(s')_1(\beta_0(s)_1(I))] \To{\beta_0(s)_1} \sum_{J \in q(1)} r[\beta'_0(s')_1(J)] \To{\beta'_{s'}} S',$$
$$\sum_{I \in p(1)} r[\beta'_0(s')_1(\beta_0(s)_1(I))] \To{\beta'_0(s')_{\beta_0(s)_1(I)}} \sum_{I \in p(1)} q[\beta_0(s)_1(I)] \To{\beta_s} S.$$%check notation for map on positions
\end{itemize}
Horizontal composition of morphisms of coalgebras, the 2-cells of the bicategory, is given simply by the cartesian product. The coherence isomorphisms and axioms for a bicategory then follow from the essential uniqueness of finite products of sets, and the unitality and associativity of composition of polynomial maps.%this may be a bit presumptuous, but I do think it's true



%--- Section ---%
\section{Product of coalgebras}


\cite[Proposition 2.13]{spivak2021learners} shows that the tensor product $\otimes$ of polynomials extends to make $\org$ a monoidal bicategory. In particular, for polynomials $p,q,p',q'$ there is a functor
$$[p,q]\coalg \times [p',q']\coalg \to \blp[p,q] \otimes [p',q']\brp\coalg \to [p \otimes p',q \otimes q']\coalg$$
derived from the map of polynomials $[p,q] \otimes [p',q'] \to [p \otimes p',q \otimes q']$ given on positions by 
$$\poly(p,q) \times \poly(p',q') \To{\otimes} \poly(p \otimes p',q \otimes q')$$
and on directions by, for $\phi : p \to q$ and $\phi' : p' \to q'$,
$$\blp\sum_{I \in p(1)} q[\phi_1(I)]\brp \times \blp\sum_{I' \in p'(1)} q'[\phi'_1(I')]\brp \from \sum_{(I,I') \in p(1) \times p'(1)} q[\phi_1(I)] \times q'[\phi'_1(I')]$$
sending $(I,I',j,j')$ to $(I,j,I',j')$.

Concretely, this tensor product takes a $[p,q]$-coalgebra $\S$ and a $[p',q']$-coalgebra $\S'$ to the $[p \otimes p',q \otimes q']$-coalgebra with states $S \times S'$, action
$$S \times S' \to \poly(p,q) \times \poly(p',q') \to \poly(p \otimes p',q \otimes q'),$$
and update described similarly componentwise. The tensor product of morphisms of coalgebras is also given by the cartesian product of functions, and it is (very) tedious but ultimately straightforward to check that the essential uniqueness of products guarantees that $\otimes$ gives a monoidal structure on $\org$.


%--- Section ---%
\section{$\org$ as a double category}


Defining $\org$ as a monoidal bicategory is sufficient for most of the constructions of $\org$-enriched structures in the next chapter. However, using a double category structure to cast morphisms $\phi\colon p\to q$ in $\poly$ as one-state coalgebras $\S_\phi\in[p,q]\coalg$ (see \cref{ex.single_state}) facilitates our eventual definition of adaptives, in particular the maps between them. 

Specifically, the definition of $\org$ as a monoidal bicategory extends to a monoidal (pseudo-)double category with coalgebras as horizontal morphisms, maps in $\poly$ as vertical morphisms, and squares as in \eqref{eqn.square} given by maps of coalgebras from $\{\psi\}\then\S$ to $\S'\then\{\phi\}$. 
\begin{equation}\label{eqn.square}
\begin{tikzcd}
p \rar[slash, ""{name=S, below}]{\S} \dar[swap]{\phi} & q \dar{\psi} \\
p' \rar[slash, ""{name=T, above},swap]{\S'} & q'
\arrow[Rightarrow,shorten=5,from=S,to=T]
\end{tikzcd}
\end{equation}

As $\{\phi\}$ and $\{\psi\}$ have only one state and composition of coalgebras acts as the cartesian product on states, such a square amounts to a function $S \to S'$ making \eqref{eqn.coalg_square} commute.
\begin{equation}\label{eqn.coalg_square}
\begin{tikzcd}
S \rar{\beta} \dar[swap]{f} & {[p,q]} \tri S \rar{\psi_\ast} & {[p,q']} \tri S \dar{{[p,q']} \tri f} \\
S' \rar[swap]{\beta'} & {[p',q']} \tri S' \rar{\phi^\ast} & {[p,q']} \tri S'
\end{tikzcd}
\end{equation}

Identities and composites for these squares are determined by the bicategory structure, as this double category is a restriction in the vertical direction of the double category of lax-commuting squares in a bicategory.\footnote{It should be noted however that the vertical arrows in $\org$ are regarded as polynomial maps rather than coalgebras, so that they compose strictly unitally and associatively.}

We now proceed to discuss various categorical structures enriched in $\org$, which describe dynamical systems equipped with extra algebraic structure that allows us to remove abstraction barriers when considering nested layers and complex arrangements of the components of the system.


%------- Chapter -------%
\chapter{Adaptives as $\org$-Enrichment}


A monoidal double category is a viable setting for enriching various categorical structures. Intuitively, enrichment in $\org$ replaces the usual set of arrows between two objects in a category or similar structure with a $[p,q]$-coalgebra for some choice of polynomials $p,q$. Therefore not only can each arrow be realized as a map of polynomials $p \to q$, but this map carries dynamics that encode how a position in $p$ and a direction in $q$ determine a transition from one arrow to another.

Different situations call for different categorical structures to model their dynamics: some systems primarily involve many-to-one arrangements such as the wiring diagrams in , %ref
others such as gradient descent fit naturally into a many-to-many arrow framework, and we expect in future work to consider evolving systems in which different components operate at differing time scales. Rather than choose one such categorical form to favor and go through the tedious exercise of forcing all of the others to conform to it, we take the approach of including a choice of categorical structure in our main definition.

\begin{definition}
An adaptive consists of:
\begin{itemize}
	\item A type $T$ of categorical structure
	\item A functor from monoidal double categories to $T$-multicategories
	\item A structure of type $T$ enriched in $\org$
\end{itemize}
\end{definition}

This definition is intentionally imprecise, so as to be maximally inclusive of different notions of categorical structures and theories of enrichment. However, our intuition and examples come from the theories of enrichment described in \cite{leinster1999generalized} and \cite{shapiro2022enrichment}. In the former, $T$ can be any suitable type of generalized multicategory, while in the latter $T$ can be any structure defined as an algebra for a familial monad on a presheaf category equipped with a choice of ``higher'' and ``lower'' dimensional cell shapes. In both cases, $T$ can be identified with a cartesian monad and $T$-algebras (our ``categorical structures'') admit an ``enriched'' analogue with respect to any $T$-multicategory. To define $T$-algebras enriched in $\org$ is then to identify $\org$ with a $T$-multicategory, and in all of our examples this identification arises naturally from the observation that monoidal double categories contain the structure of $T$-multicategories.

We make this precise in \cref{sec.org_cats} for $\org$-enriched categories, in \cref{sec.org_multicats} for $\org$-enriched multicategories, and in \cref{sec:org_monoidalcats} for $\org$-enriched monoidal categories. We are also interested in using $\org$-enriched duoidal categories to describe dynamical systems in which different contributors to a system operate at different rates, using the duoidal structure on $\org$ based on $\tri$, but that is beyond the scope of this paper.


%--- Section ---%
\section{$\org$-enriched categories}\label{sec.org_cats}


Enrichment of categories only makes use of the double category structure of $\org$, as any double category forms an $f\!c$-multicategory (also known as a virtual double category) in the sense of \cite{leinster1999generalized}. %cite specifically
The following definition of enrichment in $\org$ is an unwinded version of \cite{leinster1999generalized}, %cite specifically
which defines categories enriched in any $fc$-multicategory.

\begin{definition}\label{def.org_enriched_cat}
An $\org$-enriched category $A$ consists of
\begin{itemize}
	\item a set $A_0$ of objects;
	\item for each $a \in A_0$, a polynomial $p_a$;
	\item for each $a,b \in A_0$, a $[p_a,p_b]$-coalgebra $\S_{a,b}$;
	\item for each $a \in A_0$, an ``identitor'' square in $\org$ as in \eqref{eqn.tors} left; and
	\item for each $a,b,c \in A_0$, a ``compositor'' square in $\org$ as in \eqref{eqn.tors} right:
\begin{equation}\label{eqn.tors}
\begin{tikzcd}
p_a \dar[equals] \rar[slash, ""{name=S, below}]{\idcoalg{p_a}} & p_a \dar[equals] \\
p_a \rar[slash, ""{name=T, above},swap]{\S_{a,a}} & p_a
\arrow[Rightarrow,shorten=5,from=S,to=T]
\end{tikzcd}\qquad\qquad\begin{tikzcd}
p_a \dar[equals] \rar[slash]{\S_{a,b}} & p_b \rar[slash]{\S_{b,c}} & p_c \dar[equals] \\
p_a \ar[slash, ""{name=T, above}]{rr}[swap]{\S_{a,c}} & & p_c
\arrow[Rightarrow,shorten=4,from=1-2,to=T]
\end{tikzcd}
\end{equation}
\end{itemize}
such that these squares satisfy unit and associativity equations.%more on these?
\end{definition}

The sets $S_{a,b}$ form an underlying ordinary category of $A$. 
In fact, an $\org$-enriched category could be equivalently defined as an ordinary category such that each object $a$ is assigned a polynomial $p_a$ and each set of arrows $\Hom(a,b)$ is the set of states for an assigned $[p_a,p_b]$-coalgebra $\S_{a,b}$, with composition and identities respecting the coalgebra structure. This means that the arrow $\id_a$ in $\Hom(a,a)$ acts as the identity map on $p_a$ and is unchanged by updates, while for $f$ in $\Hom(a,b)$ and $g$ in $\Hom(b,c)$ the composite $g \circ f$ acts as the composite $p_a \to p_b \to p_c$ of the actions of $f$ and $g$, and it updates as the composite of the updates of $f,g$.



%--- Section ---%
\section{$\org$-enriched operads}\label{sec.org_multicats}


A monoidal double category also gives rise to an $f\!m$-multicategory in the sense of \cite{leinster1999generalized}, %cite specifically
%where the ``2-cells'' are horizontal arrows of the form $a_1 \otimes \cdots \otimes a_n \slasharrow b$ and the ``3-cells'' are squares from the horizontal composite of a tree-shaped arrangement of these arrows to a horizontal arrow whose domain is a tensor product with arity the number of leaves in the tree.%reword
so it makes sense to talk about multicategories enriched in $\org$ as in \cite{leinster1999generalized}. %cite specifically

\begin{definition}
An $\org$-enriched multicategory $A$ consists of
\begin{itemize}
	\item a set $A_0$ of objects;
	\item for each $a \in A_0$, a polynomial $p_a$;
	\item for each $a_1,...,a_n,b \in A_0$, a $[p_{a_1} \otimes \cdots \otimes p_{a_n},p_b]$-coalgebra $\S_{a_1,...,a_n;b}$;
	\item for each $a \in A_0$, an ``identitor'' square in $\org$ as in \eqref{eqn.multi_tors} left; and
	\item for each $a_{1,1},\ldots,a_{1,m_1},\;\ldots,\;a_{n,1},\ldots,a_{n,m_n},\;b_1,\ldots,b_n,$ and $c \in A_0$, a ``compositor'' square in $\org$ as in \eqref{eqn.multi_tors} right
\end{itemize}
\begin{equation}\label{eqn.multi_tors}
  \begin{tikzcd}[ampersand replacement=\&]
  p_a \dar[equals] \rar[slash, ""{name=S, below}]{\idcoalg{p_a}} \& p_a \dar[equals] \\
  p_a \rar[slash, ""{name=T, above},swap]{\S_{a;a}} \& p_a
  \arrow[Rightarrow,shorten=5,from=S,to=T]
  \end{tikzcd}
 \qquad\quad
  \begin{tikzcd}[column sep=huge, ampersand replacement=\&]
  p_{a_{1,1}} \otimes \cdots \otimes p_{a_{n,m_n}} \dar[equals] \rar[slash]{\otimes_i \S_{a_{i,1},...,a_{i,m_i};b_i}} \& p_{b_1} \otimes \cdots \otimes p_{b_n} \rar[slash]{\S_{b_1,...,b_n;c}} \& p_c \dar[equals] \\
  p_{a_{1,1}} \otimes \cdots \otimes p_{a_{n,m_n}} \ar[slash, ""{name=T, above}]{rr}[swap]{\S_{a_{1,1},...,a_{n,m_n};c}} \& \& p_c
  \arrow[Rightarrow,shorten=4,from=1-2,to=T]
  \end{tikzcd}
\end{equation}
such that these squares satisfy unit and associativity equations.%more on these?
\end{definition}

The sets $S_{a,b}$ form an underlying multicategory of $A$, with a description similar to that below \cref{def.org_enriched_cat}. 

We will mostly be interested in what we call an $\org$-enriched operad on $p$, the case when $A$ has only one object which is assigned the polynomial $p$. It consists simply of a $[p^{\otimes n},p]$-coalgebra $S_n$ for each $n \in \nn$ equipped with maps
\begin{equation}\label{eqn.org_operad}
\idcoalg{p} \to S_1
\qqand
\bigotimes_i S_{n_i} \to S_{\sum_i n_i}
\end{equation}
satisfying the usual equations. %\dnote{should we perhaps denote $\id_p$ by $\{\id_p\}$ to emphasize it is a single-state thingy?}

\begin{example}\label{ex.collective}
A \emph{collective} (as defined in \cite{niu2021collectives}) is a $\otimes$-monoid in $\poly$, meaning a polynomial $p$ equipped with a monoid structure on its positions $p(1)$ and co-unital co-associative ``distribution'' functions $p[I \cdot J] \to p[I] \times p[J]$ for each $I,J \in p(1)$. This can be viewed as an $\org$-enriched operad where $\S_n$ is given by $\{\cdot_n\}$, the one-element coalgebra on the $n$-ary monoidal product $\cdot_n : p^{\otimes n} \to p$, and where the maps of coalgebras in \eqref{eqn.org_operad} are isomorphisms deduced from the equations for a monoid.
\end{example}

\begin{example}
In \cref{ex.collective}, the coalgebras $\S_n$ are determined by a single map of polynomials, with no possible updates as there is only one state. This can be generalized to an intermediate notion between collectives and $\org$-enriched multicategories, where the coalgebras are still static but may have multiple states.

Given a multicategory $M$ and a multifunctor $F : M \to \poly$, there is an $\org$-enriched multicategory $A_F$ with 
\begin{itemize}
	\item object set $\ob(M)$;
	\item for each $a \in \ob(M)$, the polynomial $p_a = F(a)$;
	\item for each tuple $(a_1,...,a_n;b)$ in $\ob(M)$, $S_{a_1,...,a_n;b} = M(a_1,...,a_n;b)$;
	\item the map $\beta_0 : M(a_1,...,a_n;b) \to \poly(p_{a_1} \otimes \cdots \otimes p_{a_n},p_b)$ is given by $F$; and 
	\item this coalgebra is static, in that for any state $s$ in $M(a_1,...,a_n;b)$, the update function $\beta_s$ is the constant function at $s$.
	\qedhere
\end{itemize}
\end{example}

\begin{example}
Let $\S$ be any $p$-coalgebra for a polynomial $p$. There is an $\org$-enriched operad on $p$ with $\S_0 = \S$, $\S_1 = \idcoalg{p}$, and all other $\S_n=\varnothing$ assigned the empty coalgebra.
\end{example}

%something about wirings


%--- Section ---%
\section{$\org$-enriched monoidal categories}\label{sec:org_monoidalcats}


A monoidal double category is precisely a representable $MC$-multicategory in the sense of \cite{shapiro2022enrichment}, %cite specifically
so we can also enrich strict monoidal categories in $\org$.\footnote{We use throughout the notion \emph{strong} enrichment in a monoidal double category from \cite{shapiro2022enrichment}.} These will be similar to $\org$-enriched multicategories but allow for many-to-many coalgebras rather than just many-to-1.

\begin{definition}\label{enriched_monoidal}
An $\org$-enriched strict monoidal category $A$ consists of
\begin{itemize}
	\item a monoid $A_0$ of objects;
	\item for each $a \in A_0$, a polynomial $p_a$;
	\item an isomorphism of polynomials $y \cong p_e$ for $e$ the unit of $A_0$;
	\item for each $a,a' \in A_0$, an isomorphism of polynomials $p_{a} \otimes p_{a'} \cong p_{a a'}$;
	\item for each $a,b \in A_0$, a $[p_a,p_b]$-coalgebra $\S_{a,b}$;
	\item for each $a \in A_0$, an ``identitor'' square in $\org$ as in \cref{eqn.adaptive_tor} left;
	\item for each $a,b,c \in A_0$, a ``compositor'' square in $\org$ as in \cref{eqn.adaptive_tor} center; and
	\item for each $a,a',b,b' \in A_0$, a ``productor'' square in $\org$ as in \cref{eqn.adaptive_tor} right:
\end{itemize}
\begin{equation}\label{eqn.adaptive_tor}
\begin{tikzcd}
p_a \dar[equals] \rar[slash, ""{name=S, below}]{\idcoalg{p_a}} & p_a \dar[equals] \\
p_a \rar[slash, ""{name=T, above},swap]{\S_{a,a}} & p_a
\arrow[Rightarrow,shorten=5,from=S,to=T]
\end{tikzcd}
\qquad
\begin{tikzcd}[column sep=large]
p_a \dar[equals] \rar[slash]{\S_{a,b}} & p_b \rar[slash]{\S_{b,c}} & p_c \dar[equals] \\
p_a \ar[slash, ""{name=T, above}]{rr}[swap]{\S_{a,c}} & & p_c
\arrow[Rightarrow,shorten=4,from=1-2,to=T]
\end{tikzcd}
\qquad
\begin{tikzcd}[column sep=huge]
p_a \otimes p_{a'} \dar[equals,swap]{\wr} \rar[slash,""{name=S,below}]{\S_{a,b} \otimes \S_{a',b'}} & p_b \otimes p_{b'} \dar[equals,swap]{\wr} \\
p_{aa'} \rar[slash, ""{name=T, above},swap]{\S_{aa',bb'}} & p_{bb'}
\arrow[Rightarrow,shorten=5,from=S,to=T]
\end{tikzcd}
\end{equation}
such that these isomorphisms and squares satisfy unit, associativity, and interchange equations.%more on these?
\end{definition}

Here the sets $S_{a,b}$ form the arrows in a strict monoidal category underlying $A$. 

For the rest of this paper, we will only consider the restricted case of an $\org$-enriched strict monoidal category with object monoid $\nn$. Concretely, an adaptive of this form consists of a polynomial $p$ (so that in the notation above $p_n := p^{\otimes n}$ for $n \in \nn$) along with a $[p^{\otimes m},p^{\otimes n}]$-coalgebra $S_{m,n}$ for each $m,n \in \nn$, equipped with the maps of coalgebras as in \eqref{eqn.adaptive_tor}. We denote such an adaptive ``on p'' as $(p,\S)$, where $\S$ now encodes all of the coalgebras $\S_{m,n}$ that constitute the adaptive and the structure maps are implicit.

%\dnote{in general, please use labeled equations and references more :)}

%more on what those maps mean

%something about wirings

Morphisms of adaptives are special cases of the general notion of morphisms for enriched monoidal categories as defined in \cite{shapiro2022enrichment}. %cite specifically

\begin{definition}
A \emph{morphism} of adaptives from $(p,\S)$ to $(p',\S')$ is given by a map of polynomials $\phi : p \to p'$ and, for each $m,n \in \nn$, ``commutor'' squares as in \eqref{eqn.adaptive_map} %\dnote{like here: replace "below" by a reference to a labeled equation} 
in $\org$ which commute with the identitor, compositor, and productor squares.
\begin{equation}\label{eqn.adaptive_map}
\begin{tikzcd}
p^{\otimes m} \rar[slash, ""{name=S, below}]{\S_{m,n}} \dar[swap]{\phi^{\otimes m}} & p^{\otimes n} \dar{\phi^{\otimes n}} \\
p'^{\otimes m} \rar[slash, ""{name=T, above}, swap]{\S'_{m,n}} & p'^{\otimes n}
\arrow[Rightarrow,shorten=5,from=S,to=T]
\end{tikzcd}
\end{equation}
\end{definition}

This definition of morphism is the direct benefit for the theory of adaptives of treating $\org$ as a monoidal double category rather than as a monoidal bicategory (as done in \cite{spivak2021learners}). Otherwise morphisms could either only be easily defined between adaptives on the same polynomial, which is rather restrictive, or take the form of a $[p,p']$-coalgebra, which we believe to be too general to be of much use.

%what do these mean

\begin{example}
For a fixed polynomial $p$, there is a terminal adaptive $\S^{p!}$ on $p$ where $\S^{p!}_{m,n}$ is the terminal $[p^{\otimes m},p^{\otimes n}]$-coalgebra. 

Its states are (not necessarily finite) $[p^{\otimes m},p^{\otimes n}]$-trees: trees inductively defined by a root labeled with a polynomial map $\phi : p^{\otimes m} \to p^{\otimes n}$ and for each pair 
\begin{equation}\label{eqn.pmn_directions}
\blp(I_1,...,I_m) \in p(1)^m, (i_1,...,i_n) \in p[\phi(I_1,...,I_m)_1] \times \cdots \times p[\phi(I_1,...,I_m)_n]\brp
\end{equation}
an edge out of the root to another $[p^{\otimes m},p^{\otimes n}]$-tree. The action of such a tree is simply the root map $\phi$, and the update sends a pair as in \eqref{eqn.pmn_directions} to the new tree at the end of the corresponding edge. 

The idea is that the state-set of the terminal adaptive encodes all possible trajectories along different actions, and this coalgebra is terminal because from any other coalgebra there is a map to $\S^{p!}_{m,n}$ sending each state to the tree whose root is labeled by the action of the state and whose edges from the root go to the trees for each of the state's possible updates. This map is (uniquely) a coalgebra map because, in order to preserve actions and updates, each state must be sent to the tree rooted by its action and branching according to its updates.

The adaptive structure on the terminal coalgebra $\S^{p!}$ is then each to define, as for any identity, composition, or product $[p^{\otimes m},p^{\otimes n}]$-coalgebra there is a unique map to the terminal one, and this uniqueness automatically ensures all of the equations are satisfied. 

This is the terminal adaptive on $p$ as for any other adaptive on $p$ there is a morphism of adaptives given by the identity map on $p$ and with commutor squares to $\S^{p!}_{m,n}$ simply the unique map of coalgebras from any $[p^{\otimes m},p^{\otimes n}]$-coalgebra to the terminal one.
\end{example}



%------- Chapter -------%
\chapter{Adaptives in Nature}


Our main results are that adaptives describe phenomena in the natural world and human technologies. In this paper, we focus on deep learning and a simplified conception of objects moving under the force of gravity.


%------- Section -------%
\section{The Gradient Descent Adaptive}

Deep learning uses the algorithm of gradient descent to optimize a choice of function, based on external feedback on its output. This naturally fits into the paradigm of adaptives, as functions $\rr^m \to \rr^n$ can form the states of a polynomial coalgebra, with the feedback providing the information needed to update the choice of function. These functions can be composed and juxtaposed to provide compositions of networks of such gradient descenders in a way that respects the updates.

\begin{definition}
For the rest of this section, let 
\[S_{m,n} = \left\{(M \in \nn, f : \rr^{M+m}, p \in \rr^M) | f \textrm{ is differentiable}\right\}.
\]
\end{definition}

The idea is that these states are the possible parameters among which a gradient descender is meant to find the optimal choice, while $f$ dictates how the parameter affects the resulting function $f(p,-)$. In the dynamics of these states described below, only the value of the parameter $p$ is updated while the dimension $M$ of the parameter space and the parameterized function $f$ remain fixed, though network composition of descenders will involve combining these data in nontrivial ways.\footnote{Other versions of a gradient descent adaptive might have the states be simply some space of functions from $\rr^m$ to $\rr^n$, but this type of model is more difficult to describe in a computation-friendly manner as the space of functions that can arise from network compositions of the types of functions used in common practice is not finite dimensional.}%more on this?

%Here $M$ should be regarded as the dimension of the parameter space, $f$ a function $\rr^m \to \rr^n$ depending on a parameter in $\rr^M$, and $p$ a choice of parameter. 

Let $t = \sum_{x \in \rr} y^{T_x \rr}$.  Of course for all practical purposes $T_x \rr$ can be regarded as simply $\rr$, but in both the description of polynomials as bundles and the intuition for how we use the directions in this example it will make sense to think of the directions at $x$ as the tangent space. We proceed to define an adaptive on $t$ with $S_{m,n}$ the states of the coalgebra $\S_{m,n}$ which updates using gradient descent. The structure maps in the adaptive encode how certain networks of gradient descenders can be composed into a single descender with a larger parameter space.

\begin{definition}
The $[t^{\otimes m},t^{\otimes n}]$-coalgebra structure on $S_{m,n}$ is given by 
\begin{itemize}
	\item $\beta_0(M,f,p)_1 : \rr^m \to \rr^n$ given by $f(p,-)$
	\item For $x \in \rr^m$, $\beta_0(M,f,p)_x : T_{f(p,x)} \rr^n \to T_x \rr^m$ sends $y$ to $\pi_m Df^\top \cdot y$
	\item The update function $\beta_{M,f,p}$ sends $x \in \rr^m$ and $y \in T_{f(p,x)}$ to $(M,f,p+\epsilon \pi_M Df^\top \cdot y)$ for some fixed value of $\epsilon$
\end{itemize}
\end{definition}

The action of a state as a map $t^{\otimes m} \to t^{\otimes n}$ is given by applying the parameterized function $f$ with the parameter $p$ resulting in a function $\rr^m \to \rr^n$ as desired. The transpose of the derivative of $f$ sends a feedback vector $y \in T_{f(p,x)} \rr^n$, which can be interpreted as the difference in $\rr^n$ between the ``correct'' result for $x$ and the current approximation $f(p,x)$, to the corresponding ``correction'' to $(p,x)$ in $\rr^{M+m}$. The projection of this correction to $T_x \rr^m$ provides the action of the state on directions, which in a network can then be further propogated back down to another gradient descender that output $x$ (more on this below). The projection to $T_p \rr^M$ provides the direction and magnitude with which to update the parameters (scaled by $\epsilon$ according to the desired responsiveness of the learning).

Thus far, we have provided the data of the polynomial $t$ and the $[t^{\otimes m},t^{\otimes n}]$-coalgebra $\S_{m,n}$ needed to define an adaptive. We now define the identitor, compositor, and productor morphisms of coalgebras presented by the squares in \cref{enriched_monoidal}.
\begin{itemize}
	\item The identitors $\idcoalg{t^{\otimes n}} \to \S_{n,n}$ send the unique state in the domain to the state $(0,\id_{\rr^n},0) \in S_{n,n}$. 
	\item The compositors $\S_{\ell,m}\then\S_{m,n} \to \S_{\ell,n}$ send the pair $((L,f,p),(M,g,q))$ to 
$$\blp M+L,g(-,f(-,-)) : \rr^{M+L+\ell} \To{\id \times f} \rr^{M+m} \To{g} \rr^n, (q,p) \in \rr^{M+L} \brp.$$
	\item The productors $\S_{m,n} \otimes \S_{m',n'} \to \S_{m+m',n+n'}$ send the pair $((M,f,p),(M',f',p'))$ to $(M+M',(f,f'),(p,p'))$
\end{itemize}

These structure maps ensure that whenever two gradient descenders are combined in series or parallel, the resulting composite descender retains the parameter spaces of both. Likewise when the input or output of a descender is wired past some other descender in the network as below, %ref
it does not contribute any new parameters and its effect is merely to preserve its input/output until plugged into a descender elsewhere in the network.

%figure

\begin{theorem}\label{gradientadaptive}
These structure maps are maps of coalgebras and satisfy the coherence equations of an adaptive described in \cref{equations}.
\end{theorem}

This is proven in \cref{coherenceproofs}.




%------- Section -------%
\section{The Gravity Adaptive}


In pursuit of the idea of using adaptives to describe the dynamics of the world, we describe an adaptive that models how bodies move through space under the force of gravity. For simplicity, however, these bodies will not be prevented from overlapping so as to avoid encoding the complicated dynamics of potential collisions. This adaptive will be modeled as an $\org$-enriched operad. %sync up new terminology

\begin{definition}
For the rest of this section, let $C$ denote the unit cube in $\rr^3$ and
$$S_1 = \{(s : C \to C, v \in T_0 C) | \textrm{ s is a rectilinear embedding}\}.$$ 
An embedding $s : C \to C$ can be interpreted as a rectangular prism inside the unit cube with faces parallel to those of the outer cube. Let $S_n = S_1^n$, whose elements are made up of $n$ such prisms $\vec s = (s_1,...,s_n)$ and velocities $\vec v = (v_1,...,v_n)$.
\end{definition}

These prisms inside the unit cube are meant to describe the positions and sizes of $n$ bodies moving through space. In physical models they typically wouldn't be allowed to overlap, but for simplicity we will in effect only consider their centers of mass when computing gravitational effects. %something about boundaries. Is there an easy way out of that?

Consider the polynomial 
$$g = \sum_{m \in \rrp \\ c \in C} y^{t \in \rrnn},$$
whose positions we interpret as the mass $m$ of a body and its center of mass $c$, and whose directions we interpret as lengths of time $t$. We now describe an adaptive on $g$ with state sets $S_n$, where the action of a state computes its center of mass and the update modifies the positions and velocities of the bodies according to their current velocities and the force of gravity.

\begin{definition}
For $m_1,...,m_n \in \rrp$ and $c_1,...,c_n \in C$, representing $n$ positions in the unit cube $C$ and their masses, the vector pointing from the $i$th body to the center of mass of the others is given by
$$\Delta c_i = \frac{m_1c_1 + \cdots + \hat{m_ic_i} + \cdots m_nc_n}{m_1 + \cdots + \hat{m_i} + \cdots + m_n} - c_i.$$
The gravitational pull of the $i$th body in the system is given by
$$G_i(\vec m,\vec c) = \frac{m_i(m_1 + \cdots + \hat m_i + \cdots m_n)G}{|\Delta c_i|^3}\Delta c_i,$$
where $G$ is the gravitational constant. We will write $\vec G(\vec m, \vec c)$ for the tuple of these $n$ different vectors.
\end{definition}

\begin{definition}
The $[g^{\otimes n},g]$-coalgebra structure on $S_n$ is given by 
\begin{itemize}
	\item $\beta_0(\vec s,\vec v)_1 : \rrp^n C^n \to C$ sends $(m_1,...,m_n,c_1,...,c_n)$ to 
$$c_{\vec s,\vec m} = \frac{m_1s_1(c_1) + \cdots + m_ns_n(c_n)}{m_1 + \cdots + m_n}$$
	\item $\beta_0(\vec s,\vec v)_{\vec m,\vec c} : \rrnn \to \rrnn^n$ sends $t$ to $(t,...,t)$\footnote{This simply says that when the entire system is observed for a length of time $t$, so is each component. Perhaps this could be varied to incorporate some version of relativity.} 
	\item The update function $\beta_{\vec s,\vec v}$ sends $(\vec m \in \rrp^n,\vec c \in C^n)$ and $t \in \rrnn$ to 
$$\blp \vec s + t\vec v + \frac{t^2}{2} \vec G(\vec m, \vec s(\vec c)),\vec v + t\vec G(\vec m, \vec s(\vec c)) \brp$$
\end{itemize}
\end{definition}

This coalgebra structure is designed so that $n$ moving bodies are agglomerated into a single body by juxtaposition, with the center of mass of the new body computed as the center of mass of those that constitute it. Then for a given length of time, the positions and velocities of the original bodies are updated appropriately according to their original velocities and the force of gravity. The operadic composition of these states describe how to rescale these velocities according to the perspective of fitting their outer cube frame into a prism inside yet another outer cube.

\begin{itemize}
	\item The identitor state in $S_1$ is given by $(\id_C,0)$
	\item The operadic compositor sends 
$$(\vec s,\vec v) \in S_n, (\vec s^1,\vec v^1) \in S_{\ell_1},...,(\vec s^n,\vec v^n) \in S_{\ell_n}$$
to
$$\hspace{-1cm}\blp s_1 \circ s^1_1,...,s_1 \circ s^1_{\ell_1},s_2 \circ s^2_1,...,s_n \circ s^n_{\ell_n},v_1 + Ds_1 \cdot v^1_1,...,v_1 + Ds_1 \cdot v^1_{\ell_1},v_2 + Ds_2 \cdot v^2_1,...,v_n + Ds_n \cdot v^n_{\ell_n} \brp$$
\end{itemize}

Intuitively, the identitor describes a body filling the entire cube and not moving, while the operadic compositor describes plugging in $n$ systems into the prisms of another system. When doing so, the resulting prisms are precisely the composite embeddings of a prism of an inner system into the cube that is then again embedded into the cube as a prism in the outer system. The resulting velocities combine the velocity of the inner body in the cube of the inner system, scaled according to how that cube embeds into the cube of the outer system, then added to the velocity of the entire prism in the outer system. In other words, it is the velocity of a body moving inside a box which is itself moving.

\begin{theorem}\label{gravityadaptive}
These structure maps are maps of coalgebras and satisfy the coherence equations of an adaptive described in \cref{equations}.
\end{theorem}

This is discussed in more detail in \cref{coherenceproofs}, though the main thrust of the proof is entirely given by physical principles. The identitor picks out a static state in $S_1$, as it has zero velocity, and hence is a coalgebra morphism. It also clearly acts as an identity with respect to the compositor, as plugging an inner system into an outer system which is just one prism occupying the entire cube recovers the inner system. 

The compositor is a coalgebra because the center of mass construction is ``associative'' in the sense of being computable in stages according to any (even nested) partition of the contributing masses, and the update is the physical evolution of the bodies in the system under their velocities and gravity, which is not affected by abstraction barriers such as drawing or removing boxes around some of the masses. 

\bnote{Is this true? when the systems are rescaled it will change the distances and hence the force. This could be fine if the scaling of the velocities and distance traveled depends in the same way as the force does... but applying s on the outside scales G(m,c) once whereas applying s on the inside scales distances quadratically... this seems worrying}




%------- Chapter -------%
\appendix
\chapter{Coherence equations and proofs}\label{coherenceproofs}


We now present the equations that must be satisfied by the identitors, compositors, and productors of an adaptive. While we only provide these in the narrow setting of adaptives, the equations governing $\org$-enriched categories, multicategories, and monoidal categories are all quite similarly defined.

\begin{definition}\label{equations}
The equations between the structure maps in an adaptive are as follows:
\begin{itemize}
	\item The identitor interchange law
\begin{equation}\label{eqn.id_inter}
\hspace{-1.9cm}\begin{tikzcd}[column sep={150,between origins}]
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals] \rar[slash, ""{name=S, below}]{\idcoalg{p^{\otimes n}} \otimes \idcoalg{p^{\otimes n'}}} & 
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals] \\
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals,swap]{\wr} \ar[slash, ""{name=T, above}, ""{name=U, below}]{r}[description]{\S_{n,n} \otimes \S_{n',n'}} & 
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals,swap]{\wr} \\
p^{\otimes (n+n')} \rar[slash, ""{name=V, above},swap]{\S_{n+n',n+n'}} & 
p^{\otimes (n+n')}
\arrow[Rightarrow,shorten=5,from=S,to=T]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\end{tikzcd}\quad = \quad\begin{tikzcd}[column sep={150,between origins}]
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals,swap]{\wr} \rar[slash, ""{name=S, below}]{\idcoalg{p^{\otimes n}} \otimes \idcoalg{p^{\otimes n'}}} & 
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals,swap]{\wr} \\
p^{\otimes (n+n')} \dar[equals] \ar[slash, ""{name=T, above}, ""{name=U, below}]{r}[description]{\idcoalg{p^{\otimes (n+n')}}} & 
p^{\otimes (n+n')} \dar[equals] \\
p^{\otimes (n+n')} \rar[slash, ""{name=V, above},swap]{\S_{n+n',n+n'}} & 
p^{\otimes (n+n')}
\arrow[equals,shorten=5,from=S,to=T,swap,"\wr"]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\end{tikzcd}
\end{equation}
	\item The compositor interchange law
\begin{equation}\label{eqn.comp_inter}
\hspace{-4.3cm}\begin{tikzcd}[column sep={110,between origins}]
p^{\otimes \ell} \otimes p^{\otimes \ell'} \dar[equals,swap]{\wr} \rar[slash, ""{name=S, below}]{\S_{\ell,m} \otimes \S_{\ell',m'}} & 
p^{\otimes m} \otimes p^{\otimes m'} \dar[equals,swap]{\wr} \rar[slash, ""{name=U, below}]{\S_{m,n} \otimes \S_{m',n'}} & 
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals,swap]{\wr} \\
p^{\otimes (\ell + \ell')} \dar[equals] \rar[slash, ""{name=T, above},swap]{\S_{\ell+\ell',m+m'}} \ar[phantom,""{name=R, below}]{rr} & 
p^{\otimes (m + m')} \rar[slash, ""{name=V, above},swap]{\S_{m+m',n+n'}} & 
p^{\otimes (n + n')} \dar[equals] \\
p^{\otimes (\ell + \ell')} \ar[slash, ""{name=W, above}]{rr}[swap]{\S_{\ell+\ell',n+n'}} & & 
p^{\otimes (n + n')}
\arrow[Rightarrow,shorten=5,from=S,to=T]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\arrow[Rightarrow,shorten=5,from=R,to=W]
\end{tikzcd}\quad = \quad\begin{tikzcd}[column sep={110,between origins}]
p^{\otimes \ell} \otimes p^{\otimes \ell'} \dar[equals] \rar[slash, ""{name=S, below}]{\S_{\ell,m} \otimes \S_{\ell',m'}} \ar[phantom,""{name=R, below}]{rr} & 
p^{\otimes m} \otimes p^{\otimes m'} \rar[slash, ""{name=U, below}]{\S_{m,n} \otimes \S_{m',n'}} & 
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals] \\
p^{\otimes \ell} \otimes p^{\otimes \ell'} \dar[equals,swap]{\wr} \ar[slash, ""{name=S, above},""{name=T, below}]{rr}[description]{\S_{\ell,n} \otimes \S_{\ell',n'}} & &
p^{\otimes n} \otimes p^{\otimes n'} \dar[equals,swap]{\wr} \\
p^{\otimes (\ell + \ell')} \ar[slash, ""{name=U, above}]{rr}[swap]{\S_{\ell+\ell',n+n'}} & & 
p^{\otimes (n + n')}
\arrow[Rightarrow,shorten=5,from=R,to=S]
\arrow[Rightarrow,shorten=5,from=T,to=U]
\end{tikzcd}
\end{equation}
	\item The compositor associativity law
\begin{equation}\label{eqn.comp_assoc}
\hspace{-1.1cm}\begin{tikzcd}%[column sep={60,between origins}]
p^{\otimes k} \dar[equals] \rar[slash]{\S_{k,\ell}} \ar[phantom,""{name=S, below}]{rr} & 
p^{\otimes \ell} \rar[slash]{\S_{\ell,m}} & 
p^{\otimes m} \dar[equals] \rar[slash, ""{name=U, below}]{\S_{m,n}} & 
p^{\otimes n} \dar[equals] \\
p^{\otimes k} \dar[equals] \ar[slash, ""{name=T, above}]{rr}[swap]{\S_{k,m}} \ar[phantom,""{name=W, below}]{rrr} & &
p^{\otimes m} \rar[slash, ""{name=V, above},swap]{\S_{m,n}} & 
p^{\otimes n} \dar[equals] \\
p^{\otimes k} \ar[slash, ""{name=X, above}]{rrr}[swap]{\S_{k,n}} & & &
p^{\otimes n}
\arrow[Rightarrow,shorten=5,from=S,to=T]
\arrow[equals,shorten=5,from=U,to=V]
\arrow[Rightarrow,shorten=5,from=W,to=X]
\end{tikzcd}\quad = \quad\begin{tikzcd}%[column sep={60,between origins}]
p^{\otimes k} \dar[equals] \rar[slash,""{name=S, below}]{\S_{k,\ell}} & 
p^{\otimes \ell} \dar[equals] \rar[slash]{\S_{\ell,m}} \ar[phantom,""{name=U, below}]{rr} & 
p^{\otimes m} \rar[slash]{\S_{m,n}} & 
p^{\otimes n} \dar[equals] \\
p^{\otimes k} \dar[equals] \rar[slash, ""{name=T, above},swap]{\S_{k,\ell}} \ar[phantom,""{name=W, below}]{rrr} & 
p^{\otimes \ell} \ar[slash, ""{name=V, above}]{rr}[swap]{\S_{\ell,n}} & &
p^{\otimes n} \dar[equals] \\
p^{\otimes k} \ar[slash, ""{name=X, above}]{rrr}[swap]{\S_{k,n}} & & &
p^{\otimes n}
\arrow[equals,shorten=5,from=S,to=T]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\arrow[Rightarrow,shorten=5,from=W,to=X]
\end{tikzcd}
\end{equation}
	\item The compositor unit laws
\begin{equation}\label{eqn.comp_unit}
\hspace{-1.5cm}\begin{tikzcd}
p^{\otimes m} \dar[equals] \rar[slash,""{name=S, below}]{\idcoalg{p^{\otimes m}}} & p^{\otimes m} \dar[equals] \rar[slash,""{name=U, below}]{\S_{m,n}} & p^{\otimes n} \dar[equals] \\
p^{\otimes m} \dar[equals] \rar[slash,""{name=T, above},swap]{\S_{m,m}} \ar[phantom,""{name=W, below}]{rr} & p^{\otimes m} \rar[slash,""{name=V, above},swap]{\S_{m,n}} & p^{\otimes n} \dar[equals] \\
p^{\otimes m} \ar[slash, ""{name=X, above}]{rr}[swap]{\S_{m,n}} & & p^{\otimes n}
\arrow[Rightarrow,shorten=5,from=S,to=T]
\arrow[equals,shorten=5,from=U,to=V]
\arrow[Rightarrow,shorten=5,from=W,to=X]
\end{tikzcd}\quad = \quad\begin{tikzcd}
p^{\otimes m} \dar[equals] \rar[slash,""{name=S, below}]{\S_{m,n}} & p^{\otimes n} \dar[equals] \\
p^{\otimes m} \rar[slash, ""{name=T, above},swap]{\S_{m,n}} & p^{\otimes n}
\arrow[equals,shorten=5,from=S,to=T]
\end{tikzcd}\quad = \quad\begin{tikzcd}
p^{\otimes m} \dar[equals] \rar[slash,""{name=S, below}]{\S_{m,n}} & p^{\otimes n} \dar[equals] \rar[slash,""{name=U, below}]{\idcoalg{p^{\otimes m}}} & p^{\otimes n} \dar[equals] \\
p^{\otimes m} \dar[equals] \rar[slash,""{name=T, above},swap]{\S_{m,n}} \ar[phantom,""{name=W, below}]{rr} & p^{\otimes n} \rar[slash,""{name=V, above},swap]{\S_{n,n}} & p^{\otimes n} \dar[equals] \\
p^{\otimes m} \ar[slash, ""{name=X, above}]{rr}[swap]{\S_{m,n}} & & p^{\otimes n}
\arrow[equals,shorten=5,from=S,to=T]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\arrow[Rightarrow,shorten=5,from=W,to=X]
\end{tikzcd}
\end{equation}
	\item The productor associativity law
\begin{equation}\label{eqn.prod_assoc}
\hspace{-4.1cm}\begin{tikzcd}[column sep={180,between origins}]%work on tilted arrow
p^{\otimes m} \otimes p^{\otimes m'} \otimes p^{\otimes m''}  \dar[equals,swap]{\wr} \rar[slash,""{name=S,below}]{\S_{m,n} \otimes \S_{m',n'} \otimes \S_{m'',n''}} & p^{\otimes n} \otimes p^{\otimes n'} \otimes p^{\otimes n''} \dar[equals,swap]{\wr} \\
p^{\otimes (m + m')} \otimes p^{\otimes m''} \dar[equals,swap]{\wr} \ar[slash,""{name=T,above},""{name=U,below}]{r}[description]{\S_{m+m',n+n'} \otimes \S_{m'',n''}} & p^{\otimes (n + n')} \otimes p^{\otimes n''} \dar[equals,swap]{\wr} \\
p^{\otimes (m + m' + m'')} \rar[slash, ""{name=V, above},swap]{\S_{m+m'+m'',n+n'+n''}} & p^{\otimes (n + n' + n'')}
\arrow[Rightarrow,shorten=5,from=S,to=T]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\end{tikzcd}\quad = \quad\begin{tikzcd}[column sep={180,between origins}]
p^{\otimes m} \otimes p^{\otimes m'} \otimes p^{\otimes m''}  \dar[equals,swap]{\wr} \rar[slash,""{name=S,below}]{\S_{m,n} \otimes \S_{m',n'} \otimes \S_{m'',n''}} & p^{\otimes n} \otimes p^{\otimes n'} \otimes p^{\otimes n''} \dar[equals,swap]{\wr} \\
p^{\otimes m} \otimes p^{\otimes (m+m'')} \dar[equals,swap]{\wr} \ar[slash,""{name=T,above},""{name=U,below}]{r}[description]{\S_{m,n} \otimes \S_{m'+m'',n'+n''}} & p^{\otimes n} \otimes p^{\otimes (n' + n'')} \dar[equals,swap]{\wr} \\
p^{\otimes (m + m' + m'')} \rar[slash, ""{name=V, above},swap]{\S_{m+m'+m'',n+n'+n''}} & p^{\otimes (n + n' + n'')}
\arrow[Rightarrow,shorten=5,from=S,to=T]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\end{tikzcd}
\end{equation}
	\item The productor unit laws
\begin{equation}\label{eqn.prod_unit}
\hspace{-3.0cm}\begin{tikzcd}[column sep={130,between origins}]
p^{\otimes m} \dar[equals,swap]{\wr} \rar[slash,""{name=Q, below}]{\S_{m,n}} & p^{\otimes n} \dar[equals,swap]{\wr} \\
p^{\otimes 0} \otimes p^{\otimes m} \dar[equals] \ar[slash, ""{name=S, below}, ""{name=R, above}]{r}[description]{\idcoalg{p^{\otimes 0}} \otimes \S_{m,n}} & 
p^{\otimes 0} \otimes p^{\otimes n} \dar[equals] \\
p^{\otimes 0} \otimes p^{\otimes m} \dar[equals,swap]{\wr} \ar[slash, ""{name=T, above}, ""{name=U, below}]{r}[description]{\S_{0,0} \otimes \S_{m,n}} & 
p^{\otimes 0} \otimes p^{\otimes n} \dar[equals,swap]{\wr} \\
p^{\otimes m} \rar[slash, ""{name=V, above},swap]{\S_{m,n}} & p^{\otimes n}
\arrow[equals,shorten=5,from=Q,to=R,swap,"\wr"]
\arrow[Rightarrow,shorten=5,from=S,to=T]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\end{tikzcd}\quad = \quad\begin{tikzcd}
p^{\otimes m} \dar[equals] \rar[slash,""{name=S, below}]{\S_{m,n}} & p^{\otimes n} \dar[equals] \\
p^{\otimes m} \rar[slash, ""{name=T, above},swap]{\S_{m,n}} & p^{\otimes n}
\arrow[equals,shorten=5,from=S,to=T]
\end{tikzcd}\quad = \quad\begin{tikzcd}[column sep={130,between origins}]
p^{\otimes m} \dar[equals,swap]{\wr} \rar[slash,""{name=Q, below}]{\S_{m,n}} & p^{\otimes n} \dar[equals,swap]{\wr} \\
p^{\otimes m} \otimes p^{\otimes 0} \dar[equals] \ar[slash, ""{name=S, below}, ""{name=R, above}]{r}[description]{\S_{m,n} \otimes \idcoalg{p^{\otimes 0}}} & 
p^{\otimes n} \otimes p^{\otimes 0} \dar[equals] \\
p^{\otimes m} \otimes p^{\otimes 0} \dar[equals,swap]{\wr} \ar[slash, ""{name=T, above}, ""{name=U, below}]{r}[description]{\S_{m,n} \otimes \S_{0,0}} & 
p^{\otimes n} \otimes p^{\otimes 0} \dar[equals,swap]{\wr} \\
p^{\otimes m} \rar[slash, ""{name=V, above},swap]{\S_{m,n}} & p^{\otimes n}
\arrow[equals,shorten=5,from=Q,to=R,swap,"\wr"]
\arrow[Rightarrow,shorten=5,from=S,to=T]
\arrow[Rightarrow,shorten=5,from=U,to=V]
\end{tikzcd}
\end{equation}
\end{itemize}
\end{definition}

We now proceed to prove that the coalgebras and structure maps defined above for gradient descent and gravitational motion form adaptives. In each case, it suffices to show that the structure maps on states preserve coalgebra structure, and that equations \eqref{eqn.id_inter} through \eqref{eqn.prod_unit} are satisfied.

\begin{proof}[Proof of \cref{gradientadaptive}]
The unit and associativity equations follow immediately from associativity and unitality of addition, cartesian products, and function composition. The interchange equations follow from the preservation of 0 under addition and identity functions under cartesian products, the analogous interchange property of function composition and cartesian products of functions, and the fact that the compositors and productors act the same way on the parameters and their dimension. 

It then remains only to show that the identitors, compositors, and productors are morphisms of coalgebras. This is immediate for the productors, as each component of the action and update functions respects the cartesian products of functions and parameters that define them, so we proceed only for the identitors and compositors.

For the identitors, the state $(0,\id_{\rr^n},0)$ acts as the identity function on $\rr^n$ and on directions by the transpose of its derivative, which is also the identity. The updates in the coalgebras $\S_{n,n}$ only modify the parameter $p$, so as the parameter here is 0-dimensional this state is never changed by the update function, as is the case in the coalgebra $\idcoalg{t^{\otimes n}}$. Therefore this function is a map of coalgebras.

The compositors preserve the component of the action on positions as, for states 
$$(L \in \nn, f : \rr^{L+\ell}, p \in \rr^L) \quad \textrm{and} \quad (M \in \nn, g : \rr^{M+m}, q \in \rr^M),$$ 
we have 
$$g(q,-) \circ f(p,-) = g(-,f(-,-))(q,p,-).$$
This may seem like a trivial rewriting, but it illustrates how the compositor was defined in order for the action to be preserved, as on the left we have the composite of the actions on positions as in $\S_{\ell,m};\S_{m,n}$, and on the right we apply the compositor and take the action of the resulting state in $\S_{\ell,n}$.

To show that the compositor preserves both the action on directions and the update we note that by the chain rule, for $x \in \rr^\ell$ and $z \in T_{g(q,f(p,x))}$,
$$D\blp g(-,f(-,-)) \brp^\top z = Df^\top \cdot \pi_m(Dg^\top \cdot z) \in T_{(p,x)}\rr^{L+\ell}.$$
Applying $\pi_\ell$ to both sides above shows that the compositor preserves the action on directions, as on the left we have the action on directions after applying the compositor and on the right we have the composition of the actions of $(L,f,p)$ and $(M,g,q)$ on directions as in $\S_{\ell,m};\S_{m,n}$.

Finally for updates, we observe by the chain rule that the update rule in $\S_{\ell,n}$ agrees with that in $\S_{\ell,m};\S_{m,n}$ under the compositor, as either way for $x,z$ as above the composite state of $(L,f,p)$ and $(M,g,q)$ updates to 
$$\blp M+L,g(-,f(-,-)),\blp p + \epsilon \pi_L (Df^\top \cdot \pi_m(Dg^\top \cdot z)),q + \epsilon \pi_M(Dg^\top \cdot z) \brp \brp.$$
\end{proof}


\printbibliography 
\end{document}

%%--- Section ---%
%\section{PROPS}
%
%\begin{definition}
%A PROP $P$ consists of a set of objects $\ob(P)$ and a symmetric strict monoidal category whose monoid of objects is freely generated by $\ob(P)$. A morphism of PROPs is a strict monoidal functor that preserves generating objects.
%\end{definition}
%
%While it is technically convenient to regard a PROP as a monoidal category, it can also be thought of as a structure similar to a polycategory, with a set of objects $\ob(P)$ and sets of many-to-many morphisms $\Hom(x_1,...,x_m;x'_1,...,x'_n)$ equipped with composition, units, and permutations of the domain and codomain objects. These many-to-many morphisms correspond to $\Hom(x_1 \otimes \cdots \otimes x_m,x'_1 \otimes \cdots \otimes x'_n)$ in the corresponding monoidal category. 
%
%When $P$ has only one object $x$, we can write $\Hom(m,n)$ for the set of morphisms $x^{\otimes m} \to x^{\otimes n}$. In this case $P$ is simply a monoidal category with object monoid $\nn$.
%
%\begin{example}
%\begin{itemize}
%	\item The monoid $\nn$ regarded as a discrete monoidal category is a PROP with one object and $\Hom(m,n)$ either empty when $m \neq n$ or containing only the identity when $m=n$.
%	\item The terminal PROP has one object and a unique morphism in each $\Hom(m,n)$.
%	\item A skeleton of the category of finite sets forms a prop. The one generator is the singleton set and the monoidal structure is given by the empty set and disjoint union.
%\end{itemize}
%\end{example}
%
%%--- Section ---%
%\section{Lax functors to monoidal double categories}
%
%In order to state the definition of an adaptive, we recall various notions of lax functors out of monoidal categories.
%
%\begin{definition}%cite?
%For $\C$ a category and $\D$ a bicategory, a lax functor $F : \C \to \D$ consists of
%\begin{itemize}
%	\item an assignment $F : \ob(\C) \to \ob(\D)$
%	\item for each $c,c' \in \ob(\C)$, functions 
%$$F : \Hom_\C(c,c') \to \ob(\D(F(c),F(c')))$$
%	\item for each $c \in \ob(\C)$, an ``identitor'' 2-cell in $\D(F(c),F(c))$ 
%$$F_{\id_c} : \id_{F(c)} \Rightarrow F(\id_c)$$
%	\item for each $f : c \to c'$ and $f' : c' \to c''$ in $\C$, a ``compositor'' 2-cell  in $\D(F(c),F(c''))$
%$$F_{f \circ f'} : F(f') \circ F(f) \Rightarrow F(f' \circ f)$$
%\end{itemize}
%such that the identitors and compositors satisfy unit and associativity equations. 
%\end{definition}
%
%The equations here ensure a unique lax structure map 
%$$F_{f_1 \circ \cdots \circ f_n} : F(f_n) \circ \cdots \circ F(f_1) \Rightarrow F(f_n \circ \cdots \circ f_1)$$
%built out of composites of whiskerings of the identitors and compositors, for all $n \ge 0$ and composable morphisms $f_1,...,f_n$.
%
%\begin{definition}%cite? Gurski's thesis mentions lax functors of tricategories which should give a similar notion aside from the strict monoidality on objects and iso-ness of the monoidality equations
%For $\C$ a monoidal category and $\D$ a monoidal double category, a lax monoidal lax functor $F : \C \to \D$ consists of
%\begin{itemize}
%	\item a lax functor $F : \C \to \D$
%	\item an ``identitor'' vertical morphism in $\D$ %is this ok? it's a 1-cell not a 2-cell like the other...
%$$F_I : I_\D \to F(I_\C)$$
%	\item for each $c_1,c_2 \in \ob(\C)$, a ``productor'' vertical morphism in $\D$ 
%$$F_{c_1,c_2} : F(c_1) \otimes F(c_2) \to F(c_1 \otimes c_2)$$
%	\item for each $f_1 : c_1 \to c_1'$ and $f_2 : c_2 \to c_2'$ in $\C$, a ``productor'' square $F_{f_1 \otimes f_2}$ in $\D$
%\[\begin{tikzcd}
%F(c_1) \otimes F(c_2) \dar[swap]{F(f_1) \otimes F(f_2)} \ar[""{name=S, below}]{r}{F_{c_1,c_2}} & F(c_1 \otimes c_2) \dar{F(f_1 \otimes f_2)} \\
%F(c_1') \otimes F(c_2') \ar[""{name=T, above}]{r}[swap]{F_{c_1',c_2'}} & F(c_1' \otimes c_2')
%\arrow[Rightarrow,shorten=5,from=S,to=T]
%\end{tikzcd}\]
%\end{itemize}
%such that the identitor and productors satisfy unit and associativity equations up to coherent isomorphisms, %this differs from Gurski, but we really don't want to deal with making these lax. say something about this
%along with interchange equations with respect to the identitors and compositors coming from the lax functoriality of $F$. 
%\end{definition}
%
%These equations guarantee that for any $m$ strings of $n$ composable morphisms in $\C$, there is a unique coherence square from the result of first applying $F$ on each morphism then taking products and composites in $\D$, to the result of first taking products and composites in $\C$ then applying $F$.%maybe write these out in the appendix
%
%\begin{proposition}
%For $\C$ a monoidal category and $\D$ a monoidal double category, the following are equivalent.
%\begin{enumerate}%be more specific about strictness
%	\item A lax monoidal lax functor $F : \C \to \D$ such that $F_{c_1,c_2}$ is the identity for all $c_1,c_2 \in \ob(\C)$\footnote{Note that this strict monoidality condition is not assumed for the squares $F_{f_1 \otimes f_2}$}
%	\item A lax functor $F$ from $\C$ to the horizontal bicategory of $\D$ such that $F(c_1 \otimes c_2) = F(c_1) \otimes F(c_2)$ for all $c_1,c_2 \in \ob(\C)$, and the following diagram commutes for all
%
%\end{enumerate}
%\end{proposition}

